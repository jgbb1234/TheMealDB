<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TheMealDB Recipe Finder</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #333;
      color: #fff;
      padding: 20px;
      text-align: center;
    }

    h1 {
      margin: 0;
    }

    input[type="text"] {
      padding: 10px;
      margin: 10px;
      width: 60%;
    }

    button {
      padding: 10px 20px;
      background-color: #4caf50;
      color: #fff;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    #mealContainer {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }

    .meal-card {
      width: 250px;
      margin: 20px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .meal-card:hover {
      transform: scale(1.05);
    }

    .meal-card img {
      width: 100%;
      border-top-left-radius: 5px;
      border-top-right-radius: 5px;
    }

    .meal-info {
      padding: 15px;
    }

    .meal-info h3 {
      margin: 0;
      font-size: 18px;
      color: #333;
    }

    .meal-info p {
      margin: 5px 0;
      color: #666;
    }

    .meal-details-container {
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .meal-details-container h2 {
      margin-top: 0;
      color: #333;
    }

    .meal-details-container h3 {
      margin: 10px 0;
      color: #333;
    }

    .meal-details-container p {
      color: #666;
    }

    .meal-details-container img {
      max-width: 100%;
      border-radius: 5px;
      margin-bottom: 20px;
    }

    .meal-details-container ul {
      list-style-type: none;
      padding: 0;
    }

    .meal-details-container ul li {
      margin-bottom: 5px;
    }
  </style>
</head>

<body>
  <header>
    <h1>TheMealDB Recipe Finder</h1>
    <input type="text" id="searchInput" placeholder="Search for a meal...">
    <button id="searchBtn">Search</button>
  </header>
  <main id="mealContainer">
    <!-- Meal cards will be dynamically added here -->
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', async function () {
      const searchInput = document.getElementById('searchInput');
      const searchBtn = document.getElementById('searchBtn');
      const mealContainer = document.getElementById('mealContainer');

      // Function to fetch random meals from API
      async function getRandomMeals(numberOfMeals, apiKey) {
        let meals = [];
        for (let i = 0; i < numberOfMeals; i++) {
          const response = await fetch(`https://www.themealdb.com/api/json/v1/1/random.php?key=${apiKey}`);
          const data = await response.json();
          meals.push(data.meals[0]);
        }
        return meals;
      }

      // Function to fetch meals by search term from API
      async function getMeals(searchTerm, apiKey) {
        const response = await fetch(`https://www.themealdb.com/api/json/v1/1/search.php?s=${searchTerm}&key=${apiKey}`);
        const data = await response.json();
        return data.meals;
      }

      // Function to display meals
      function displayMeals(meals) {
        mealContainer.innerHTML = ''; // Clear existing content
        if (meals) {
          meals.forEach(meal => {
            const mealCard = document.createElement('div');
            mealCard.classList.add('meal-card');
            mealCard.innerHTML = `
                            <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
                            <div class="meal-info">
                                <h3>${meal.strMeal}</h3>
                                <p>Category: ${meal.strCategory}</p>
                                <p>Area: ${meal.strArea}</p>
                            </div>
                        `;
            mealCard.addEventListener('click', () => showMealDetails(meal.idMeal));
            mealContainer.appendChild(mealCard);
          });
        } else {
          mealContainer.innerHTML = '<p>No meals found. Please try a different search term.</p>';
        }
      }

      // Function to fetch meal details by ID
      async function getMealDetails(mealId, apiKey) {
        const response = await fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${mealId}&key=${apiKey}`);
        const data = await response.json();
        return data.meals[0];
      }

      // Function to display meal details
      async function showMealDetails(mealId) {
        clearContent(); // Clear existing content
        const apiKey = '1'; // Using the test API key for now
        const mealDetails = await getMealDetails(mealId, apiKey);
        const mealDetailsContainer = document.createElement('div');
        mealDetailsContainer.classList.add('meal-details-container');
        mealDetailsContainer.innerHTML = `
          <h2>${mealDetails.strMeal}</h2>
          <img src="${mealDetails.strMealThumb}" alt="${mealDetails.strMeal}">
          <p>Category: ${mealDetails.strCategory}</p>
          <p>Area: ${mealDetails.strArea}</p>
          <h3>Ingredients</h3>
          <ul>
            ${getIngredientsList(mealDetails)}
          </ul>
          <h3>Instructions</h3>
          <ul>
            ${getInstructionsList(mealDetails.strInstructions)}
          </ul>
        `;
        mealContainer.appendChild(mealDetailsContainer);
      }

      // Function to clear all content on the page
      function clearContent() {
        mealContainer.innerHTML = ''; // Clear meal container
      }

      // Function to get ingredients list
      function getIngredientsList(mealDetails) {
        let ingredientsList = '';
        for (let i = 1; i <= 20; i++) {
          const ingredient = mealDetails[`strIngredient${i}`];
          const measure = mealDetails[`strMeasure${i}`];
          if (ingredient && measure) {
            ingredientsList += `<li>${ingredient} - ${measure}</li>`;
          } else if (ingredient) {
            ingredientsList += `<li>${ingredient}</li>`;
          }
        }
        return ingredientsList;
      }

      // Function to get instructions list
      function getInstructionsList(instructions) {
        // Split instructions into separate lines
        const instructionsArray = instructions.split('\n');
        let instructionsList = '';
        // Create list items for each instruction line
        instructionsArray.forEach(instruction => {
          instructionsList += `<li>${instruction.trim()}</li>`;
        });
        return instructionsList;
      }

      // Event listener for search button click
      searchBtn.addEventListener('click', async () => {
        const searchTerm = searchInput.value.trim();
        if (searchTerm !== '') {
          clearContent(); // Clear existing content
          const meals = await getMeals(searchTerm, '1'); // Using the test API key for now
          displayMeals(meals);
        }
      });

      // Initial fetch for random meals when the page loads
      const numberOfRandomMeals = 5; // Display 5 random meals
      const apiKey = '1'; // Use the test API key for now
      const randomMeals = await getRandomMeals(numberOfRandomMeals, apiKey);
      displayMeals(randomMeals);
    });

  </script>
</body>

</html>